# APPTrixTestProject

# Задачи
* Создать модель участников. У участника должна быть аватарка, пол, имя и фамилия, почта.
* Создать эндпоинт регистрации нового участника: /api/clients/create (не забываем о пароле и совместимости с авторизацией модели участника).
* При регистрации нового участника необходимо обработать его аватарку: наложить на него водяной знак (в качестве водяного знака можете взять любую картинку).
* Создать эндпоинт оценивания участником другого участника: /api/clients/{id}/match. В случае, если возникает взаимная симпатия, то ответом выдаем почту клиенту и отправляем на почты участников: «Вы понравились <имя>! Почта участника: <почта>».
Создать эндпоинт списка участников: /api/list. Должна быть возможность фильтрации списка по полу, имени, фамилии. Советую использовать библиотеку Django-filters.
* Реализовать определение дистанции между участниками. Добавить поля долготы и широты. В api списка добавить дополнительный фильтр, который показывает участников в пределах заданной дистанции относительно авторизованного пользователя. Не забывайте об оптимизации запросов к базе данных.

# Описание API
## 1. /api/clients/create [POST]
  Ендпоинт для регистрации пользователей
  ### Входные данные:
  * username
    + Описание: никнейм пользователя
    + Формат: TEXT
    + Примечание: уникальное поле
  * password
    + Описание: пароль пользователя
    + Формат: TEXT
  * avatar
    + Описание: никнейм юзера
    + Формат: IMAGE
    + Примечание: при отсутствии картинки в запрасе используется дефолтная картинка сервера
  * first_name
    + Описание: имя пользователя 
    + Формат: TEXT
  * last_name
    + Описание: фамилия пользователя 
    + Формат: TEXT
  * email
    + Описание: почта пользователя 
    + Формат: TEXT
    + Примечание: уникальное поле
  * position_latitude
    + Описание: широта нахождения пользователя при регистрации
    + Формат: FLOAT
    + Примечание: ограничение от -90.0 до +90.0
  * position_longitude
    + Описание: долгота нахождения пользователя при регистрации
    + Формат: FLOAT
    + Примечание: ограничение от -180.0 до +180.0
  * sex
    + Описание: пол пользователя
    + Формат: INT
    + Примечание: на тестовом сервере допустимыые данные пола : 1 - Мужской, 2 - Женский

  ### Выходные данные:
  * id
  * first_name
  * last_name
  * sex
  * username
  * email
  * avatar
  * position_latitude
  * position_longitude
## 2. /api/clients/auth [POST]
  Ендпоинт для аутентификации и авторизации пользователей
  ### Входные данные:
  * username
    + Описание: никнейм пользователя
    + Формат: TEXT
  * password
    + Описание: пароль пользователя
    + Формат: TEXT
  ### Выходные данные:
  * Token
    + Описание: токен авторизации
    + Примечание: передавать в header в формате 'Token <токен>'

## 3. /api/clients/{id}/match
  Ендпоинт для оценки пользователей
  Примечание: Только для авторизованных пользователей
  ### Важно! Отравка email на почту участников реализована, но при тестировании все сообщения блокировались как спам!

##  4. /api/list [GET]
  Ендпоинт для отображения списка пользователей
  ### Параметры запроса:
  * first_name
    + Формат: TEXT
  * last_name
    + Формат: TEXT
  * sex
    + Формат: INT
  * distance
    + Описание: Дистанция от авторизованного пользователя в метрах.
    + Формат: INT/FLOAT
    + Примечание: Требуется авторизация

# Хостинг для тестирования 
~~~
  http://212.118.53.33/api
~~~
## Примечания по поводу хостига
Для обслуживания работы проекта импользуются:
* Redis
* Celery
* Gunicorn
* Nginx

#  Примечания
* Дополнительно была добавлена функция нахождения дистанции при помощи формулы haversine, которая, при желании, может обеспечить более точный отбор, возвращаемой из базы данных выборки.
* Отправка email реализована с помощью celery.
* Обработка фото реализована с помощью pillow.
